import{_ as s,b as i,o as a,a8 as n}from"./chunks/framework.BwoOF8WG.js";const c=JSON.parse('{"title":"离线存储","description":"","frontmatter":{"title":"离线存储"},"headers":[],"relativePath":"material/endorsement/8.html/offline-storage.md","filePath":"material/endorsement/8.html/offline-storage.md"}'),l={name:"material/endorsement/8.html/offline-storage.md"},h=n(`<p>离线存储指的是：在用户没有网络连接时，可以正常访问站点或应用，在用户有网络连接时，更新用户机器行的缓存文件</p><h2 id="工作原理" tabindex="-1">工作原理 <a class="header-anchor" href="#工作原理" aria-label="Permalink to &quot;工作原理&quot;">​</a></h2><p>html5 的离线存储是基于一个新建的 .appache 文件的缓存机制，通过这个文件的解析清单来离线存储资源，这些资源可以像 cookie 一样被存储，当网络处于断开情况时，浏览器就会通过被离线存储的数据进行页面展示</p><h2 id="工作流程" tabindex="-1">工作流程 <a class="header-anchor" href="#工作流程" aria-label="Permalink to &quot;工作流程&quot;">​</a></h2><p>在线的情况下，浏览器发现 html 头部有 mainfest 属性，它会请求 mainfest 文件，如果是第一次访问页面，那么浏览器就会根据 mainfest 文件的内容下载相应的资源并进行离线存储。</p><p>如果已经访问过页面并且资源已经进行离线存储了，那么浏览器就会使用离线的资源加载页面，然后浏览器会对比新的 mainfest 文件与旧的 mainfest 文件，如果文件没有发生改变，则不做任何操作；如果文件发生了改变，就会重新下载文件中的资源并进行离线存储。</p><p>在离线的情况下，浏览器会直接使用离线存储的资源。</p><h2 id="主意事项" tabindex="-1">主意事项 <a class="header-anchor" href="#主意事项" aria-label="Permalink to &quot;主意事项&quot;">​</a></h2><ol><li>浏览器对缓存数据的容量限制可能不太一样。某些浏览器设置的限制是每个站点 5MB</li><li>如果 manifest 文件或者内部列举的某一个文件不能正常下载，那么整个更新过程都将会失败，浏览器将继续使用旧的缓存</li><li>引用 manifest 的 html 必须与 manifest 文件同源</li><li>FALLBACK 中的资源必须与 manifest 文件同源</li><li>当一个资源被缓存后，该浏览器直接请求这个绝对路径时也会访问缓存中的资源</li><li>站点中的其他页面，即使没有设置 manifest 属性，请求的资源如果在缓存中，则也会从缓存中访问</li><li>当 manifest 文件发生改变时，资源请求本身也会触发更新</li></ol><h2 id="例子" tabindex="-1">例子 <a class="header-anchor" href="#例子" aria-label="Permalink to &quot;例子&quot;">​</a></h2><h3 id="_1-创建-manifest-appcache-文件" tabindex="-1">1. 创建 manifest.appcache 文件 <a class="header-anchor" href="#_1-创建-manifest-appcache-文件" aria-label="Permalink to &quot;1. 创建 manifest.appcache 文件&quot;">​</a></h3><ul><li>CACHE：表示需要离线存储的资源列表，由于包含 manifest 文件的页面将被自动离线存储，所以不需要把页面本身也列出来</li><li>NETWORK：表示在它下面列出来的资源只有在在线的情况下才能访问，它们不会被离线存储，所以在离线情况下无法使用这些资源。不过，如果在 CACHE 和 NETWORK 中有一个相同的资源，那么这个资源还是会被离线存储，也可以说 CACHE 的优先级更高</li><li>FALLBACK：表示如果访问第一个资源失败，那么就使用第二个资源来替换它。例如：/ /offline.html 表示用 offline.html 替换 /</li></ul><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes light-plus dark-plus vp-code" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;" tabindex="0"><code><span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">CACHE</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> MANIFEST</span></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-dark:#6A9955;"># 版本号或注释</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">CACHE:</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">/index.html</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">/app.js</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">NETWORK:</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">FALLBACK:</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">/</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> /offline.html</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>在这个清单中，我们列出了要缓存的文件（index.html 和 app.js），以及网络请求的策略。NETWORK: * 表示其他文件都需要联网获取。FALLBACK: / /offline.html 表示如果访问任何未缓存的页面，则显示离线页面 offline.html</p><h3 id="_2-更新-html-文件" tabindex="-1">2. 更新 HTML 文件 <a class="header-anchor" href="#_2-更新-html-文件" aria-label="Permalink to &quot;2. 更新 HTML 文件&quot;">​</a></h3><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes light-plus dark-plus vp-code" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;" tabindex="0"><code><span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;!</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">DOCTYPE</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> html</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">html</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> manifest</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;manifest.appcache&quot;</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">  &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">head</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">meta</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> charset</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;UTF-8&quot;</span><span style="--shiki-light:#800000;--shiki-dark:#808080;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">meta</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> name</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;viewport&quot;</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> content</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;width=device-width, initial-scale=1.0&quot;</span><span style="--shiki-light:#800000;--shiki-dark:#808080;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">title</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">Offline Todo List</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">title</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">  &lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">head</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">  &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">body</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">h1</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">Offline Todo List</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">h1</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">form</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> id</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;todoForm&quot;</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">      &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">label</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> for</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;task&quot;</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">Task:</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">label</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">      &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">input</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> type</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;text&quot;</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> id</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;task&quot;</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> required</span><span style="--shiki-light:#800000;--shiki-dark:#808080;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">      &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">button</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> type</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;submit&quot;</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">Add Task</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">button</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">form</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">ul</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> id</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;taskList&quot;</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;&lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">ul</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">script</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> src</span><span style="--shiki-light:#000000FF;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;app.js&quot;</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;&lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">script</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">  &lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">body</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">html</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_3-创建一个离线页面" tabindex="-1">3. 创建一个离线页面 <a class="header-anchor" href="#_3-创建一个离线页面" aria-label="Permalink to &quot;3. 创建一个离线页面&quot;">​</a></h3><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes light-plus dark-plus vp-code" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;" tabindex="0"><code><span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;!</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">DOCTYPE</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> html</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">html</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">  &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">head</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">meta</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> charset</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;UTF-8&quot;</span><span style="--shiki-light:#800000;--shiki-dark:#808080;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">meta</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> name</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;viewport&quot;</span><span style="--shiki-light:#E50000;--shiki-dark:#9CDCFE;"> content</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">=</span><span style="--shiki-light:#0000FF;--shiki-dark:#CE9178;">&quot;width=device-width, initial-scale=1.0&quot;</span><span style="--shiki-light:#800000;--shiki-dark:#808080;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">title</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">Offline</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">title</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">  &lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">head</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">  &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">body</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">    &lt;</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">h1</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">You are offline</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">h1</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">  &lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">body</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#800000;--shiki-dark:#808080;">&lt;/</span><span style="--shiki-light:#800000;--shiki-dark:#569CD6;">html</span><span style="--shiki-light:#800000;--shiki-dark:#808080;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_4-更新-js-文件" tabindex="-1">4. 更新 js 文件 <a class="header-anchor" href="#_4-更新-js-文件" aria-label="Permalink to &quot;4. 更新 js 文件&quot;">​</a></h3><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes light-plus dark-plus vp-code" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;" tabindex="0"><code><span class="line"><span style="--shiki-light:#008000;--shiki-dark:#6A9955;">// 获取任务列表</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">const</span><span style="--shiki-light:#0070C1;--shiki-dark:#4FC1FF;"> taskListElement</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> = </span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">document</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">getElementById</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;taskList&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-dark:#6A9955;">// 从 localStorage 中加载任务</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">function</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;"> loadTasks</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">() {</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">  const</span><span style="--shiki-light:#0070C1;--shiki-dark:#4FC1FF;"> tasks</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> = </span><span style="--shiki-light:#0070C1;--shiki-dark:#4FC1FF;">JSON</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">parse</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">localStorage</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">getItem</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;tasks&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">)) || [];</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">  tasks</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">forEach</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">((</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">task</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">) </span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">=&gt;</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;"> addTaskToDOM</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">task</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">));</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-dark:#6A9955;">// 将任务添加到任务列表和 localStorage</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">function</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;"> addTask</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">task</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">  const</span><span style="--shiki-light:#0070C1;--shiki-dark:#4FC1FF;"> tasks</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> = </span><span style="--shiki-light:#0070C1;--shiki-dark:#4FC1FF;">JSON</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">parse</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">localStorage</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">getItem</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;tasks&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">)) || [];</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">  tasks</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">push</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">task</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">  localStorage</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">setItem</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;tasks&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#0070C1;--shiki-dark:#4FC1FF;">JSON</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">stringify</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">tasks</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">));</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">  addTaskToDOM</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">task</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-dark:#6A9955;">// 将任务添加到任务列表</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">function</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;"> addTaskToDOM</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">task</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">  const</span><span style="--shiki-light:#0070C1;--shiki-dark:#4FC1FF;"> taskItem</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> = </span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">document</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">createElement</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;li&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">  taskItem</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">textContent</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> = </span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">task</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">  taskListElement</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">appendChild</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">taskItem</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-dark:#6A9955;">// 处理表单提交</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">document</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">  .</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">getElementById</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;todoForm&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">)</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">  .</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">addEventListener</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;submit&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">, </span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">function</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> (</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">event</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">    event</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">preventDefault</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">    const</span><span style="--shiki-light:#0070C1;--shiki-dark:#4FC1FF;"> taskInput</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> = </span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">document</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">getElementById</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;task&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">    const</span><span style="--shiki-light:#0070C1;--shiki-dark:#4FC1FF;"> task</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> = </span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">taskInput</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">value</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">trim</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">();</span></span>
<span class="line"><span style="--shiki-light:#AF00DB;--shiki-dark:#C586C0;">    if</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> (</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">task</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> !== </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">) {</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">      addTask</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">(</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">task</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">);</span></span>
<span class="line"><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">      taskInput</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">.</span><span style="--shiki-light:#001080;--shiki-dark:#9CDCFE;">value</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> = </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">;</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#008000;--shiki-dark:#6A9955;">// 初始化时加载任务</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">loadTasks</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>在这个例子中，我们使用 Application Cache 的 manifest 文件，并且增加了一个离线页面。当用户离线时，如果访问缓存中不存在的页面，将显示离线页面。在在线状态下，仍然可以添加和查看任务</p>`,21),p=[h];function t(k,e,r,d,D,g){return a(),i("div",null,p)}const C=s(l,[["render",t]]);export{c as __pageData,C as default};
